##' badge of bioconductor release version
##'
##'
##' @title badge_bioc_release
##' @param pkg package
##' @param color badge color
##' @return badge in markdown syntax
##' @export
##' @author Guangchuang Yu
##' @importFrom rvcheck check_bioc
badge_bioc_release <- function(pkg, color) {
    p1 <- "[![releaseVersion](https://img.shields.io/badge/release%20version-"
    v <- check_bioc(pkg)$latest_version
    url <- paste0("https://bioconductor.org/packages/", pkg)
    p2 <- ".svg?style=flat)]("
    badge <- paste0(p1, v, "-", color, p2, url, ")")
    return(badge)
}


##' badge of bioconductor devel version
##'
##'
##' @title badge_bioc_devel
##' @param pkg package
##' @param color badge color
##' @return badge in markdown syntax
##' @export
##' @author Guangchuang Yu
badge_bioc_devel <- function(pkg, color) {
    p1 <- "[![develVersion](https://img.shields.io/badge/devel%20version-"
    v <- ver_devel(pkg)
    p2 <- ".svg?style=flat)]("
    url <- paste0("https://github.com/GuangchuangYu/", pkg)
    badge <- paste0(p1, v, "-", color, p2, url, ")")
    return(badge)
}

##' get devel version number of specific package
##'
##'
##' @title ver_devel
##' @param pkg package name
##' @return devel version
##' @author Guangchuang
##' @importFrom rvcheck check_github
##' @export
ver_devel <- function (pkg) {
    flag <- FALSE
    if (file.exists("DESCRIPTION")) {
        x <- readLines("DESCRIPTION")
        flag <- TRUE
    } else if (file.exists("../DESCRIPTION")) {
        x <- readLines("../DESCRIPTION")
        flag <- TRUE
    }
    if (flag) {
        y <- x[grep("^Version", x)]
        v <- sub("Version: ", "", y)
        if ((as.numeric(gsub("\\d+\\.(\\d+)\\.\\d+", "\\1", v))%%2) ==
            1) {
            return(v)
        }
    }


    return(check_github(paste0("GuangchuangYu/", pkg))$latest_version)
}
